<!DOCTYPE html>
<html lang="en">
<head>
	<title>Sugioarto</title>
	<meta charset="UTF-8" />
	<link rel="stylesheet" type="text/css" href="../../../../css/default.css" />
	<link rel="shortcut icon" type="image/png" href="../../../../img/favicon.png" />
	<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-59952473-1', 'auto');ga('send', 'pageview');</script>
	
</head>

<body>
	<div class="sidebar">
		<ul>
			<li><a href="../../../../index.html">Main page</a></li>
			<li><a href="../../../../projects/index.html">Projects</a></li>
			<li><a href="../../../../contact/index.html">Contact</a></li>
		</ul>
	</div>

	<a name="top"></a>
	<div class="head"><div class="ornament"></div><h1>Sugioarto</h1></div>

	<div class="as">
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
		<!-- Skyscraper -->
		<ins class="adsbygoogle"
			style="display:inline-block;width:300px;height:600px"
			data-ad-client="ca-pub-6843164300322635"
			data-ad-slot="5260616199"></ins>
		<script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
	</div>
	<div class="main">
		<noscript>
			<div class="warning">
			<h1>JavaScript is not enabled</h1>
			<p>Please enable JavaScript for this webpage to make it function properly.</p>
			</div>
		</noscript>

<div class="nav"><a href="../../../../articles/2015/08/21/managing-freebsd-jails.html">«&nbsp;Previous article</a></div>
<div class="date">2015-09-27</div>
<h1>Upgrade Phabricator</h1>

<p><a href="http://www.phabricator.org/">Phabricator</a> is a great project
management application. It is also easy to upgrade and this
is very important for administrators. I wrote down some steps
how to update Phabricator.

<p>Phabricator needs to be installed from the distribution to work correctly.
Do not install it from <a href="http://www.freebsd.org/">FreeBSD</a> ports or packages.</p>

<h2>Stop everything</h2>

<p>If you have <code>nginx</code>, stop it instead of Apache. I assume that
you are running <code>aphlict</code> with user <code>phd</code>. If not, adjust the
command below accordingly. You need to stop <code>php-fpm</code>, too, in
case you run it for your webserver.</p>

<p><code><code># /usr/local/lib/php/phabricator/bin/phd stop
</code>
<code># /usr/local/etc/rc.d/apache24 stop
</code>
<code># sudo -u phd /usr/local/lib/php/phabricator/bin/aphlict stop
</code>
</code></p>

<h2>Upgrade Ports</h2>

<p>It makes sense to upgrade the entire packages before
going on.</p>

<p><code># portmaster -ad
</code></p>

<h2>Update Phabricator Installation</h2>

<p><code><code># cd /usr/local/lib/php/libphutil
</code>
<code># git pull
</code>
<code># cd /usr/local/lib/php/arcanist
</code>
<code># git pull
</code>
<code># cd /usr/local/lib/php/phabricator
</code>
<code># git pull
</code>
</code></p>

<p>Make sure you are on the <code>stable</code> branch in each of the
repositories above.</p>

<h2>Upgrade Database Schema</h2>

<p>For Phabricator to run properly, you need to update
the database schema.</p>

<p><code># /usr/local/lib/php/phabricator/bin/storage upgrade
</code></p>

<p>Answer any questions that may appear. Mostly just "yes" is enough.
You can re-run the command above to be sure everything has been
upgraded properly.</p>

<h2>Start Everything Again</h2>

<p>If you run <code>php-fpm</code>, start it first.
If you have <code>nginx</code>, start it instead of Apache. I assume that
you are running <code>aphlict</code> with user <code>phd</code>. If not, adjust the
command below accordingly.</p>

<p><code><code># /usr/local/etc/rc.d/apache24 start
</code>
<code># /usr/local/lib/php/phabricator/bin/phd start
</code>
<code># sudo -u phd /usr/local/lib/php/phabricator/bin/aphlict start
</code>
</code></p>

		<div class="footer">» <a href="#top">Scroll back to top</a><a name="bottom"></a></div>
	</div>
</body>
</html>
